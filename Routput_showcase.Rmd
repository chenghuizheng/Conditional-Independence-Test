---
title: "R-Output Presenattion"
author: "Chenghui Zheng"
date: '`r Sys.Date()`'
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE,warning=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(MASS)
library(tidyverse)
library(ggplot2)
library(cowplot)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
loco1 <- read.csv("r_output/simulation_loco1.csv")
loco2 <- read.csv("r_output/simulation_loco2.csv")
loco3 <- read.csv("r_output/simulation_loco3.csv")
loco4 <- read.csv("r_output/simulation_loco4.csv")
```

### (a) Linear Model with Independent Predictors

\[ Y_1 \sim X_1 + X_2 + X_3 + X_4 + 1.5X_5 + 3X_6 + 5X_7 + 10X_8 + \epsilon \]

### (b) Linear Model with Correlated Predictors

\[ Y_2 \sim X_1 + X_2 + X_3 + X_4 + 1.5X_5 + 3X_6 + 5X_7 + 10X_8 + \epsilon \]

Where \(X_1 \not\perp\!\!\!\perp X_2\) and \(\text{cov}(X_1, X_2) = 0, 0.5, 0.75, 0.9\) respectively.

### (c) Linear Model with Correlated Predictors and Different SNR

\[ Y_3 \sim X_1 + X_2 + X_3 + X_4 + 1.5X_5 + 3X_6 + 5X_7 + 10X_8 + \epsilon \]

Where \(\text{cov}(X_i, X_j) = \rho^{|i-j|}\) and \(\epsilon \sim N(0, \sigma^2)\) with \(\sigma^2 = 0.1, 0.5, 0.75, 2.1\).

### (d) Non-linear Model 

\[ Y_4 \sim 2X_1^2 + 2\cos(4X_2) + \sin(X_3) + \exp\left(\frac{X_4}{3}\right) + 3X_5 X_6 + 5 X_7 + \max(0, X_8) \]


## LOCO only

```{r,echo=FALSE,warning=FALSE,message=FALSE,eval=FALSE}
loco1$Features <- factor(loco1$Features, levels = paste0("X", 1:20))
pl1 <- ggplot(loco1, aes(x = Features, y = Feature_Importance_Score)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  geom_errorbar(aes(ymin = LB, ymax = UB), width = 0.2, color = 'black') +
  labs(title = 'Case a): ',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
loco1$Features <- factor(loco1$Features, levels = paste0("X", 1:20))
 pl1 <- ggplot(loco1, aes(x = Features, y = Rank)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue')  +
  geom_hline(yintercept = 8, linetype = "dashed", color = "red") +
  labs(title = 'Case a): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal() 
pl1 
```



```{r,echo=FALSE,warning=FALSE,message=FALSE,eval=FALSE}
loco2$Features <- factor(loco2$Features, levels = paste0("X", 1:20))
loco2$Correlation <- as.factor(loco2$Correlation)
pl2 <-ggplot(loco2, aes(x = Features, y = Feature_Importance_Score, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case b):',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()


pl2 

```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
loco2$Features <- factor(loco2$Features, levels = paste0("X", 1:20))
loco2$Correlation <- as.factor(loco2$Correlation)
 pl2 <- ggplot(loco2, aes(x = Features, y = Rank, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  geom_hline(yintercept = 8, linetype = "dashed", color = "red") +
  labs(title = 'Case a): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal() 


pl2 

```


```{r,echo=FALSE,warning=FALSE,message=FALSE}
#plot_grid(pl1, pl2, labels = "AUTO")
```


```{r,echo=FALSE,warning=FALSE,message=FALSE,eval=FALSE}
loco3$Features <- factor(loco3$Features, levels = paste0("X", 1:20))
loco3$snr <- as.factor(loco3$snr)
pl3 <- ggplot(loco3, aes(x = Features, y = Feature_Importance_Score, color = snr)) +
  geom_point(size = 3) +
  geom_line(aes(group = snr), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case c): ',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl3
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
loco3$Features <- factor(loco3$Features, levels = paste0("X", 1:20))
loco3$snr <- as.factor(loco3$snr)
pl3 <- ggplot(loco3, aes(x = Features, y = Rank, color = snr)) +
  geom_point(size = 3) +
  geom_line(aes(group = snr), size = 1)+
  geom_hline(yintercept = 8, linetype = "dashed", color = "red")+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case c): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl3
```





```{r,echo=FALSE,warning=FALSE,message=FALSE,eval=FALSE}
loco4$Features <- factor(loco4$Features, levels = paste0("X", 1:20))
pl4 <- ggplot(loco4, aes(x = Features, y = Feature_Importance_Score)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  geom_errorbar(aes(ymin = LB, ymax = UB), width = 0.2, color = 'black') +
  labs(title = 'Case d): ',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl4
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
loco4$Features <- factor(loco4$Features, levels = paste0("X", 1:20))
pl4 <- ggplot(loco4, aes(x = Features, y = Rank)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  geom_hline(yintercept = 8, linetype = "dashed", color = "red") +
  labs(title = 'Case d): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl4
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
#plot_grid(pl1,pl2,pl3, pl4, labels = "AUTO")
```

## GCM filter first + LOCO
```{r,echo=FALSE}
alg1 <- read.csv("r_output/simulation_alg1.csv")
alg2 <- read.csv("r_output/simulation_alg2.csv")
alg3 <- read.csv("r_output/simulation_alg3.csv")
alg4 <- read.csv("r_output/simulation_alg4.csv")
```

```{r,echo=FALSE,eval=FALSE}
alg1$Features<-factor(alg1$Features, levels = paste0("X", 1:20))
pl1 <- ggplot(alg1, aes(x = Features, y = Feature_Importance_Score)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  geom_errorbar(aes(ymin = LB, ymax = UB), width = 0.2, color = 'black') +
  labs(title = 'Case a):',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl1

alg2$Features <- factor(alg2$Features, levels = paste0("X", 1:20))
alg2$Correlation <- as.factor(alg2$Correlation)
pl2 <-ggplot(alg2, aes(x = Features, y = Feature_Importance_Score, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case b):',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl2 
```

```{r,echo=FALSE}
alg1$Features<-factor(alg1$Features, levels = paste0("X", 1:20))
pl1 <- ggplot(alg1, aes(x = Features, y = Rank)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  labs(title = 'Case a):',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl1

alg2$Features <- factor(alg2$Features, levels = paste0("X", 1:20))
alg2$Correlation <- as.factor(alg2$Correlation)
pl2 <-ggplot(alg2, aes(x = Features, y = Rank, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case b):',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl2 
```

```{r,echo=FALSE, eval=FALSE}
alg3$Features <- factor(alg3$Features, levels = paste0("X", 1:20))
alg3$snr <- as.factor(alg3$snr)
pl3 <- ggplot(alg3, aes(x = Features, y = Feature_Importance_Score, color = snr)) +
  geom_point(size = 3) +
  geom_line(aes(group = snr), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case c): ',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl3
```

```{r,echo=FALSE}
alg3$Features <- factor(alg3$Features, levels = paste0("X", 1:20))
alg3$snr <- as.factor(alg3$snr)
pl3 <- ggplot(alg3, aes(x = Features, y = Rank, color = snr)) +
  geom_point(size = 3) +
  geom_line(aes(group = snr), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case c): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl3
```

```{r,echo=FALSE,eval=FALSE}
alg4$Features <- factor(alg4$Features, levels = paste0("X", 1:20))
pl4 <- ggplot(alg4, aes(x = Features, y = Feature_Importance_Score)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue') +
  geom_errorbar(aes(ymin = LB, ymax = UB), width = 0.2, color = 'black') +
  labs(title = 'Case d): ',
       x = 'Features',
       y = 'Feature Importance Score') +
  theme_minimal()
pl4
```

```{r,echo=FALSE}
alg4$Features <- factor(alg4$Features, levels = paste0("X", 1:20))
pl4 <- ggplot(alg4, aes(x = Features, y = Rank)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue')  +
  labs(title = 'Case d): ',
       x = 'Features',
       y = 'Averaged Rank') +
  theme_minimal()
pl4
```

```{r,echo=FALSE}
#plot_grid(pl1,pl2,pl3, pl4, labels = "AUTO")
```

\pagebreak
## GCM only
```{r,echo=FALSE,eval=FALSE}
gcm1 <- read.csv("r_output/simulation_gcm_loco1.csv")
gcm2 <- read.csv("r_output/simulation_gcm_loco2.csv")
gcm3 <- read.csv("r_output/simulation_gcm_loco3.csv")
gcm4 <- read.csv("r_output/simulation_gcm_loco4.csv")
feature <- c('X1', 'X2','X3','X4')
gcm1$Features <- feature
gcm2$Features <- feature
gcm3$Features <- rep(feature,times=4)
gcm4$Features <- rep(feature,times=4)

```

```{r,echo=FALSE,eval=FALSE}
pl1 <- ggplot(gcm1, aes(x = Features, y = Rejection_Rate)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue')+
  labs(title = 'Case a):',
       x = 'Features',
       y = 'Rejection_Rate') +
  theme_minimal()

pl2 <- ggplot(gcm2, aes(x = Features, y = Rejection_Rate)) +
  geom_point(color = 'blue', size = 3) +
  geom_line(aes(group = 1), color = 'blue')+
  labs(title = 'Case b):',
       x = 'Features',
       y = 'Rejection_Rate') +
  theme_minimal()

```

```{r,echo=FALSE}
#plot_grid(pl1, pl2, labels = "AUTO")
```

```{r,echo=FALSE,eval=FALSE}
gcm3$Correlation <- as.factor(gcm3$Correlation)
pl3 <- ggplot(gcm3, aes(x = Features, y = Rejection_Rate, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case c): ',
       x = 'Features',
       y = 'Rejection_Rate') +
  theme_minimal()
```

```{r,echo=FALSE,eval=FALSE}
gcm4$Correlation <- as.factor(gcm4$Correlation)
pl4 <- ggplot(gcm4, aes(x = Features, y = Rejection_Rate, color = Correlation)) +
  geom_point(size = 3) +
  geom_line(aes(group = Correlation), size = 1)+
  scale_color_brewer(palette = "Set1") +
  labs(title = 'Case d): ',
       x = 'Features',
       y = 'Rejection_Rate') +
  theme_minimal()
```

```{r,echo=FALSE,eval=FALSE}
plot_grid(pl1,pl2,pl3, pl4, labels = "AUTO")
```
\pagebreak
####################GCM Simulation###################################
```{r,echo=FALSE,eval=FALSE}
gcm_s1 <- read.csv("r_output/simulation_gcm1.csv")
gcm_s2 <- read.csv("r_output/simulation_gcm2.csv")
```

$$
a) Z \sim N(0,1), X = 2*sin(Z) + 0.1*N(0,1), Y = 2*sin(Z) + 0.1*N(0,1)
$$

```{r,echo=FALSE,eval=FALSE}

ggplot(gcm_s1, aes(x = Sample_Size, y = Rejection_Rate)) +
  geom_line() +
  geom_point() +
  labs(title = "Rejection Rate vs. Sample Size",
       x = "Sample Size",
       y = "Rejection Rate") +
  theme_minimal()
```
$$
b) Z \sim N(0,1), X = 2*Z + 0.1*N(0,1), Y = 2*Z + 0.1*N(0,1)
$$
```{r, echo=FALSE,eval=FALSE}
ggplot(gcm_s2, aes(x = Sample_Size, y = Rejection_Rate)) +
  geom_line() +
  geom_point() +
  labs(title = "Rejection Rate vs. Sample Size",
       x = "Sample Size",
       y = "Rejection Rate") +
  theme_minimal()

```

